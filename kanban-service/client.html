<!DOCTYPE html>
<html>
<head>
    <title>Kanban Real-Time Test</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body { font-family: monospace; padding: 20px; background: #222; color: #eee; }
        .log { margin-bottom: 5px; padding: 5px; border-radius: 4px; }
        .green { background: #1b5e20; } /* Created */
        .blue { background: #0d47a1; }  /* Updated */
        .red { background: #b71c1c; }   /* Deleted */
    </style>
</head>
<body>
    <h2>Status: <span id="status" style="color:gray">Connecting...</span></h2>
    <div id="messages"></div>

    <script>
        const socket = io('http://localhost:3003');

        // 1. Connection Status
        socket.on('connect', () => {
            document.getElementById('status').innerText = "Connected! ğŸŸ¢";
            document.getElementById('status').style.color = "#4caf50";
            console.log("Connected to server");
        });

        socket.on('disconnect', () => {
            document.getElementById('status').innerText = "Disconnected ğŸ”´";
            document.getElementById('status').style.color = "#f44336";
        });

        // 2. Listen for NEW Tasks (Green)
        socket.on('task:created', (data) => {
            console.log("Created:", data);
            addMessage(`ğŸ†• New Task: ${data.title} (ID: ${data.id})`, 'green');
        });

        // 3. Listen for UPDATED Tasks (Blue) <--- This was likely missing!
        socket.on('task:updated', (data) => {
            console.log("Updated:", data);
            addMessage(`ğŸ”„ Updated Task ${data.id}: Status is now ${data.status}`, 'blue');
        });

        // 4. Listen for DELETED Tasks (Red)
        socket.on('task:deleted', (data) => {
            console.log("Deleted:", data);
            addMessage(`ğŸ—‘ï¸ Deleted Task ID: ${data.id}`, 'red');
        });

        function addMessage(text, className) {
            const div = document.createElement('div');
            div.className = `log ${className}`;
            div.innerText = text;
            document.getElementById('messages').appendChild(div);
        }
    </script>
</body>
</html>
